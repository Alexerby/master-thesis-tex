%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% METHOD
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%TODO: Maybe reference table A1 in appendix, conditional per different types.
%TODO: Not mentioned how we dealt with measurement errors
%TODO: Did you compare simulated eligibility rates with official BAföG statistics?
%TODO: We need to do sensitivity analysis 
%TODO: How closely do simulated award amounts match reported distributions? Use appendix distribution
%TODO: Also use timeline in appendix for the comparison of theoretical to reported
%TODO: 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Method} 
This study proceeds in two main steps. 
First, we perform a microsimulation to calculate theoretical BAföG eligibility and award amounts based on statutory rules applied to individual-level survey data. 
This simulation serves to identify who is entitled to student aid under the legal framework. Microsimulation is particularly suited here because it accounts for individual differences in backgrounds and family situations, applying complex eligibility rules precisely.

Second, we estimate two binary response models along with a linear probability model to analyze behavioural non-take-up.
That is, the likelihood that students eligible for BAföG according to the simulation nonetheless do not receive it. 
These models incorporate relevant socioeconomic and demographic factors to explore determinants of non-take-up beyond eligibility alone.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Microsimulation
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Microsimulation of Theoretical BAföG Eligibility}
To analyze non-take-up, we identify eligible students based on statutory criteria, irrespective of actual receipt. 
We implement a microsimulation model that reconstructs individual eligibility and award amounts using detailed SOEP survey data and applicable legal rules. 
Figure~\ref{fig:pipeline-overview} provides an overview of the approach.

\input{tikzfigs/simulation_algo.tex}

The microsimulation pipeline calculates theoretical BAföG eligibility and award amounts for students in the SOEP-Core sample, allowing comparison with self-reported BAföG take-up.

The model replicates the legal rules and means-testing procedures outlined in BAföG \citep{bafoeg_law} for 2007–2021, applying them to individual-level data on income, assets, housing costs, and household structure.

Unlike earlier studies, we focus solely on higher education students aged 18 and older. This ensures a consistent target group, as BAföG eligibility and structure differ between higher education and vocational training. 
Limiting the sample to adults also improves data quality, since key variables are reliably reported only for respondents aged 18+, while data for minors are often incomplete or proxy-reported \citep{soep_pgen_2025, soep_dtc_2005}.

From a policy perspective, university students are central to current debates on BAföG reform, particularly regarding debt aversion, housing costs, and equitable access. Focusing on this group enhances the relevance of our findings for ongoing policy discussions.

This approach enables a systematic assessment of the alignment between statutory entitlements and actual BAföG participation. 
Differences between simulated and reported outcomes may reflect reporting errors, administrative exceptions, or incomplete data. 
For a detailed example of the full calculation logic applied to an actual observation, see Appendix~\ref{appendix:simulation-example}.

Although some SOEP variables are approximations rather than exact administrative records, the dataset remains the most comprehensive source for studying BAföG non-take-up. 
Our eligibility measure, grounded in statutory rules, offers sufficient accuracy to support a systematic analysis of take-up behaviour and its determinants.

Notably, measurement error in reported income is the variable most likely to influence our simulation results. 
To assess the robustness of our eligibility classification to such errors, we conduct a sensitivity analysis by introducing varying levels of normally distributed noise to the log-transformed income variables prior to recalculating theoretical BAföG entitlements. 
This approach helps evaluate how income misreporting might impact our findings.


\subsubsection{Identifying the Non-Take-Up Rate and Beta Error}
%TODO: Not referenced correctly
We define non-take-up of BAföG in line with Nelson and Nieuwenhuis (2019), as the circumstance when a person is eligible for welfare, but does not receive it. This is in line with terminology commonly used in literature on welfare take up rates. Non take up rate is thus the number of people who are eligible, but do not receive it, divided by the total number of people eligible. 


Formally, this is expressed as:

\begin{equation}
\Pr(\text{NTU} = 1 \mid M = 1) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 0 \ \text{and} \ M_i = 1\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 1\}}, \quad\text{where} 
\end{equation}

\begin{equation}
  \mathbf{1}\{\cdot\} =
  \begin{cases}
  1 & \text{if individual } i \text{ is eligible but does not take up BAföG}, \\
  0 & \text{otherwise}.
  \end{cases}
\label{eq:indicator-function-ntu}
\end{equation}


\paragraph{Beta Error (Type II Error).}  
It is worth noting, however, that these situations are often more complex. 
In some cases, individuals may receive BAföG even though they are not eligible. 
This can occur due to fraud or simply as a result of administrative errors. 
Such cases introduce the concept of beta errors. 
A beta error refers to the probability that a student receives BAföG despite being classified as ineligible by our model. 
It captures false positives in the eligibility classification; cases where students who should not qualify according to the simulation nonetheless receive financial support.

Formally, it is expressed as:
\begin{equation}
\Pr(\text{TU} = 1 \mid M = 0) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 1 \ \text{and} \ M_i = 0\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 0\}},
\end{equation}
where \( \mathbf{1}\{\cdot\} \) is the indicator function defined as
\[
\mathbf{1}\{\cdot\} =
\begin{cases}
1 & \text{if individual } i \text{ is ineligible but receives BAföG}, \\
0 & \text{otherwise}.
\end{cases}
\]

% Maybe ref all our data sources, the statutory and soep
\subsubsection{Simulation Pipeline}
The pipeline begins by assembling a harmonized dataset of student-level observations from SOEP-Core and manually harmonizing variables which are not harmonized already.
This is achieved by filtering for individuals who are enrolled in education, fall within the relevant survey years, and are at least 18 years old. 
To ensure a valid estimation of parental contributions, the dataset is further restricted to cases where income data from both legal parents are observable in the panel in order to reduce bias and ensure validity of estimated parental contributions.

\paragraph{Calculating Own Income.} 
This student-level dataset serves as the core of the simulation pipeline, providing the central structure to which all additional information is appended. 
It integrates sociodemographic variables, including sex, age, partnership status, number of siblings, number of children, household composition, and federal state of residence. 
Gross student income is also appended at this stage. 
Net student income is derived from gross values by applying year-specific rules for income tax, solidarity surcharge, and church tax where applicable, as well as standard deductions such as the Werbungskostenpauschale (in accordance with §§~21–23 BAföG; \citep{bafoeg_law}). 
This net income will later be used to compute the student’s excess income as part of the BAföG need assessment.

\paragraph{Calculating Parental Contributions.}
Accurate parental income information is essential for constructing a credible BAföG means test. 
To ensure consistency in the simulation, the analysis is restricted to students for whom income data from both legal parents are available within the household files. 
This means that cases where one or both parents cannot be identified or linked within the dataset—such as due to absence, non-response, or household separation—are excluded from the simulation sample.

The simulation pipeline aggregates and evaluates parental income to estimate the expected contribution toward the student’s BAföG entitlement. 
For each student, the incomes of both legal parents—identified within the household and linked through SOEP family structure data—are retrieved and converted into annual net income. 
The net income of parents are retrieved the same way as the students own income (applying income tax, solidarity surcharge, standard deductions and church tax).

Net incomes from both parents are combined into a joint parental income measure. 
From this, the model subtracts statutory allowances (as defined in §§\,24–25 BAföG \citep{bafoeg_law}), which vary depending on the number of parents, number of dependent children, and year-specific legal thresholds. 
Additional deductions are applied if the student has siblings who might also be eligible for support. 
The result is a measure of excess parental income, which feeds directly into the theoretical award calculation.


\paragraph{Measuring Assets.}
SOEP collects asset data only every five years (2007, 2012, 2017, and 2022), leaving gaps in between. 
To address this, we used linear interpolation to estimate missing values. 
Although asset values may not always change linearly, this straightforward method allows us to create a continuous asset measure suitable for the microsimulation.

The simulation applies an asset test to evaluate whether students possess financial resources exceeding statutory exemption thresholds. 
For each student, net assets are calculated by aggregating financial assets, real estate, business holdings, private insurances, vehicles, and other tangible property, minus reported debts. 
These total net assets are then compared against the exemption limits set out in §\,29 BAföG \citep{bafoeg_law}, which depend on age, partnership status, and number of dependent children. 
Any amount above the relevant threshold is considered excess and reduces the student's calculated need.

\paragraph{Modelling taxes.}
Full tax-return simulations, such as those in \cite{herber_non-take-up_2019}, require detailed information (e.g., deductions, extraordinary expenses) that the SOEP does not always provide.  
Therefore, we approximate net parental income using the statutory tax bracket formulas of §\,32a EStG, updated annually since 2007 \citep{estg_law,estg_2025,estg_2024,estg_2023,estg_2022,estg_2021,estg_2020,estg_2019,estg_2018,estg_2017,estg_2016,estg_2015,estg_2014,estg_2013,estg_2012,estg_2007,estg_2006}.

\paragraph{Need calculation and theoretical entitlement.}
In the final stage, the simulation model determines the student's funding need by combining the statutory base need, housing allowance, and health insurance supplement, as specified in §\,13 BAföG \cite{bafoeg_law}. 
From this total amount, any excess income of the student, their parents, and any excess assets are deducted.The remainder represents the student's theoretical monthly BAföG entitlement. 

In its simplest form, this can be expressed as:

\begin{equation}
    \text{Entitlement} = \text{Need} - \text{Excess Income} - \text{Excess Assets}
\end{equation}

A positive entitlement does not automatically imply eligibility: the model also applies age-based eligibility criteria. 
Students are only considered theoretically eligible if they meet the age requirements defined in the law, typically under 30 for undergraduate studies and under 35 for graduate-level programs. 
The final output includes both the simulated monthly award and a binary eligibility flag, which are used for comparison against self-reported values in SOEP. 
Detailed examples of this calculation and relevant thresholds are provided in Appendix~\ref{appendix:simulation-example}.

\subsubsection{Eligibility Misclassification and Beta Errors}
A key limitation in simulating benefit take-up is the presence of beta errors cases where individuals report receiving BAföG but are classified as ineligible by the model. 
These mismatches often arise from measurement errors in the underlying data, particularly in income reporting, rather than from incorrect self-reports of benefit receipt \citep{frick_claim_2007, janssens_takemod_2022}. 
Because the analysis relies on self-reported survey data, both income and benefit receipt are subject to potential inaccuracies. 
Without access to administrative records, it is not possible to determine whether such discrepancies reflect true model misclassification or reporting error.

Although the simulation closely follows the legal framework, discrepancies with actual BAföG decisions may also result from unobserved factors, missing household information, or administrative exceptions not captured in the data. Nonetheless, it offers a consistent, transparent, and policy-relevant benchmark for analysing eligibility and take-up patterns over time.

To assess the reliability of the simulation, we implement two complementary strategies. 
First, we conduct a sensitivity analysis by adding normally distributed noise to the log-transformed income variables, evaluating how plausible levels of income misreporting affect non-take-up estimates and classification outcomes. 

Second, we report and interpret the share of false negatives (beta errors) as an indicator of potential model misclassification.

\begin{equation} \label{eq:accuracy_microsimulation}
    \text{Accuracy} = \frac{\text{True Positives} + \text{True Negatives}}{\text{Total number of cases}}
\end{equation}

While these measures cannot fully eliminate uncertainty, they provide a basis for evaluating the robustness of the results and identifying areas where eligibility classification may be less reliable. The findings should therefore be interpreted with caution, particularly in light of prior evidence that even modest levels of misreporting can substantially affect take-up analyses \citep{pudney_impact_2001}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Binary Choice Model of Non-Take-Up
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Binary Choice Model}

To study the determinants of non-take-up (NTU) of BAföG among theoretically eligible students, we estimate a binary choice model of the form
\begin{equation}
  \Pr(\mathrm{NTU} = 1 \mid \mathbf{X}) = F(\mathbf{X}^\top \boldsymbol{\beta}),
\end{equation}
where \( \mathrm{NTU} \) is a binary indicator for non-take-up, \( \mathbf{X} \) is the vector of covariates listed in Table~\ref{tab:descriptive_ntu_all}, and \( F(\cdot) \) is a link function that maps the linear index to a probability.\footnote{
This formulation can be motivated by a latent variable model: \( \mathrm{NTU}^* = \mathbf{X}^\top \boldsymbol{\beta} + \varepsilon \), where \( \mathrm{NTU}^* \) is an unobserved continuous variable and \( \varepsilon \) follows a standard normal distribution (probit) or a logistic distribution (logit). The observed binary outcome is \( \mathrm{NTU} = 1 \) if \( \mathrm{NTU}^* > 0 \), and \( \mathrm{NTU} = 0 \) otherwise.
}

We consider three specifications for \( F(\cdot) \), corresponding to commonly used binary choice models. 
The Probit model uses the cumulative distribution function (CDF) of the standard normal distribution, the Logit model uses the CDF of the standard logistic distribution, and the Linear Probability Model (LPM) uses a linear functional form.

\begin{table}[H]
\footnotesize
\centering
\label{tab:model_specifications}
\begin{tabular}{@{}lll@{}}
\toprule
\textbf{Model} & \textbf{Link Function \( F(\mathbf{X}^\top \boldsymbol{\beta}) \)} & \textbf{Estimation Method} \\ \midrule
Probit (Standard Normal CDF) & \( \Phi(\mathbf{X}^\top \boldsymbol{\beta}) \) & Maximum Likelihood \\
Logit (Standard Logistic CDF) & \( \Lambda(\mathbf{X}^\top \boldsymbol{\beta}) \) & Maximum Likelihood \\
Linear Probability Model & \( \mathbf{X}^\top \boldsymbol{\beta} \) & Ordinary Least Squares (OLS) \\
\bottomrule
\end{tabular}
\caption{Specifications of the Binary Choice Models}
\end{table}

All models are estimated on a pooled cross-section of theoretically eligible individuals (\( n = 458 \)), as we restrict the sample to observations with complete parental income information. 
Although the SOEP is a panel, we do not exploit its longitudinal structure here due to the limited sample size.

\paragraph{Interpretation and Comparison.} 
The logit and probit models are nonlinear estimators of the probability of non-take-up, based on an underlying latent index framework. 
Their coefficients represent changes in the unobserved latent variable and are not directly interpretable in terms of changes in the probability of the observed outcome. 
To facilitate interpretation, we report average marginal effects (AMEs), which approximate the average change in the probability of non-take-up associated with a one-unit increase in each covariate.\footnote{The AME for covariate \( X_k \) is computed as the sample analogue of the population moment \( \mathbb{E}[f(\mathbf{X}^\top \boldsymbol{\beta}) \cdot \beta_k] \), where \( f(\cdot) \) is the derivative of the link function \( F(\cdot) \). Specifically,
\[
    \widehat{\text{AME}}_k 
    = \frac{1}{n} \sum_{i=1}^n f(\mathbf{X}_i^\top \hat{\boldsymbol{\beta}}) \cdot \hat{\beta}_k
    = \mathbb{E}_n \left[ f(\mathbf{X}^\top \hat{\boldsymbol{\beta}}) \cdot \hat{\beta}_k \right],
\]
where \( \mathbb{E}_n[\cdot] \) denotes the empirical expectation over the sample.}

In practice, logit and probit models typically yield similar qualitative results, with differences largely driven by the tails of the distribution. We report both for completeness.

The LPM serves as a linear benchmark. 
While it can produce predicted probabilities outside the \([0,1]\) range and has some limitations in modelling binary outcomes, it provides a simple and transparent interpretation as coefficients directly represents the marginal effects.

\subsubsection{Key Predictors of Non-Take-Up}
Our model includes a set of explanatory variables informed by existing literature and the institutional context of BAföG. 
These variables capture a range of factors that may influence students' decisions about applying for financial aid, including demographic characteristics, socioeconomic background, and selected behavioural traits. 
In particular, we incorporate variables such as risk preferences, migration background, and prior family experience with BAföG to reflect differences in access to information, attitudes toward borrowing, and familiarity with the application process. 
While our primary goal is to estimate the association between these factors and non-take-up among eligible students, the inclusion of conceptually relevant variables also helps to account for sources of heterogeneity that might otherwise bias the estimated effects of financial incentives.

The rationale for including several of these variables is further elaborated below, drawing on prior research and theoretical considerations. In particular, the inclusion of factors like risk attitudes, family experience with the application process, and regional socialization helps account for variation in informational access, institutional trust, and attitudes toward public support.

\paragraph{Risk appetite, impulsiveness and patience.}  
To understand why some eligible students don’t apply for BAföG, we consider their willingness to take risks.  
Even though BAföG comes with relatively safe and generous terms, risk-averse students might still shy away from taking on any debt.  
By including this measure, we aim to see if risk preferences explain some of the non-take-up behaviour.  

\cite{herber_non-take-up_2019} also control for risk attitudes in their study, mainly to check if risk aversion influences take-up or interacts with traits like impatience.  
While they find no strong effect, they argue it’s important to keep it in the model — and we follow their lead here.  

Alongside risk appetite, we account for impulsiveness and patience using scales constructed by SOEP based on several survey questions.  
These behavioural traits might shape how students make financial decisions, so including them helps capture more of the individual variation behind BAföG take-up.

\paragraph{East German socialisation.}  
Whether a student lives in East Germany could shape their attitudes toward state support, reflecting historical and cultural influences.  
Research by \cite{alesina_good-bye_2007} shows that former GDR residents tend to favour redistribution more and trust state support even generations after reunification.  
So, we use this regional indicator as a proxy for such socialisation effects.  
Since it turns out significant in our model, it likely captures meaningful differences in how students view and respond to BAföG.

\paragraph{Sibling prior experience with BAföG.}  
Having an older sibling who previously received BAföG might ease the application process by providing guidance and familiarity.  
According to Herber et al. (2019), this kind of family experience can lower informational and procedural barriers, making it easier for students to follow through.  
Including this factor helps us see if such informal support within families influences take-up decisions.

\paragraph{Migration background.}  
We distinguish between direct and indirect migration backgrounds to explore whether less familiarity with the German aid system affects take-up.  
Students from migrant households might face additional challenges understanding eligibility or navigating the application, partly due to lower financial literacy documented in recent studies \citep{Tsegay_2024}.  
Accounting for migration background helps us uncover structural or informational hurdles that could contribute to lower BAföG uptake.

\paragraph{Parental education.}  
Parental education often shapes students’ educational and financial behaviours.  
We flag students whose parents hold at least a bachelor’s degree as coming from higher-educated households to test whether this background affects BAföG application patterns.

\paragraph{Siblings who have claimed BAföG.}  
Beyond older siblings, any sibling with prior BAföG experience could provide valuable insights or encouragement.  
This variable lets us check if broader family exposure to BAföG matters.

\paragraph{Age, sex, and partnership status.}  
Finally, we control for basic demographics that may influence financial aid decisions.  
Age reflects where students are in their studies or life course, which can change their financial needs or familiarity with administrative procedures.  
Sex (female) captures potential gender-related differences in financial choices or access to information.  
And partnership status accounts for how having a partner might affect household resources, financial planning, or information sharing relevant to BAföG take-up.

% By controlling for these demographic characteristics, we aim to ensure that our analysis more accurately isolates the effects of other variables of interest.



