%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% METHOD
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%TODO: Maybe reference table A1 in appendix, conditional per different types.
%TODO: Not mentioned how we dealt with measurement errors
%TODO: Did you compare simulated eligibility rates with official BAföG statistics?
%TODO: We need to do sensitivity analysis 
%TODO: How closely do simulated award amounts match reported distributions? Use appendix distribution
%TODO: Also use timeline in appendix for the comparison of theoretical to reported
%TODO: 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Method} 
This study proceeds in two main steps. 
First, we perform a microsimulation to calculate theoretical BAföG eligibility and award amounts based on statutory rules applied to individual-level survey data. 
This simulation serves to identify who is entitled to student aid under the legal framework. Microsimulation is particularly suited here because it accounts for individual differences in backgrounds and family situations, applying complex eligibility rules precisely.

Second, we estimate two binary response models along with a linear probability model to analyze behavioural non-take-up.
That is, the likelihood that students eligible for BAföG according to the simulation nonetheless do not receive it. 
These models incorporate relevant socioeconomic and demographic factors to explore determinants of non-take-up beyond eligibility alone.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Microsimulation
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Microsimulation of Theoretical BAföG Eligibility}

To analyze non-take-up, we identify eligible students based on statutory criteria, irrespective of actual receipt. 
We implement a microsimulation model that reconstructs individual eligibility and award amounts using detailed SOEP survey data and applicable legal rules. 
Figure~\ref{fig:pipeline-overview} provides an overview of the approach.

\input{tikzfigs/simulation_algo.tex}

The microsimulation pipeline calculates theoretical BAföG eligibility and award amounts for students in the SOEP-Core sample, allowing comparison with self-reported BAföG take-up.

The model replicates the legal rules and means-testing procedures outlined in BAföG \citep{bafoeg_law} for 2007–2021, applying them to individual-level data on income, assets, housing costs, and household structure.

Unlike earlier studies, we focus solely on higher education students aged 18 and older. This ensures a consistent target group, as BAföG eligibility and structure differ between higher education and vocational training. 
Limiting the sample to adults also improves data quality, since key variables are reliably reported only for respondents aged 18+, while data for minors are often incomplete or proxy-reported \citep{soep_pgen_2025, soep_dtc_2005}.

From a policy perspective, university students are central to current debates on BAföG reform, particularly regarding debt aversion, housing costs, and equitable access. Focusing on this group enhances the relevance of our findings for ongoing policy discussions.

This approach enables a systematic assessment of the alignment between statutory entitlements and actual BAföG participation. 
Differences between simulated and reported outcomes may reflect reporting errors, administrative exceptions, or incomplete data. 
For a detailed example of the full calculation logic applied to an actual observation, see Appendix~\ref{appendix:simulation-example}.

\paragraph{Limitations and accuracy.}
While our simulation closely follows the legal framework, discrepancies with actual BAföG decisions can arise due to unobserved factors, missing household details, or administrative exceptions not captured in the data. 
Nonetheless, the microsimulation provides a consistent, transparent, and policy-relevant benchmark for analysing eligibility and take-up patterns over time.

Although some SOEP variables are approximations rather than exact administrative records, the dataset remains the most comprehensive source for studying BAföG non-take-up. 
Our eligibility measure, grounded in statutory rules, offers sufficient accuracy to support a systematic analysis of take-up behaviour and its determinants.

Notably, measurement error in reported income is the variable most likely to influence our simulation results. 
To assess the robustness of our eligibility classification to such errors, we conduct a sensitivity analysis by introducing varying levels of normally distributed noise to the log-transformed income variables prior to recalculating theoretical BAföG entitlements. 
This approach helps evaluate how income misreporting might impact our findings.


\subsubsection{Identifying the Non-Take-Up Rate and Beta Error}
%TODO: Not referenced correctly
We define non-take-up of BAföG in line with Nelson and Nieuwenhuis (2019), as the circumstance when a person is eligible for welfare, but does not receive it. This is in line with terminology commonly used in literature on welfare take up rates. Non take up rate is thus the number of people who are eligible, but do not receive it, divided by the total number of people eligible. 


Formally, this is expressed as:

\begin{equation}
\Pr(\text{NTU} = 1 \mid M = 1) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 0 \ \text{and} \ M_i = 1\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 1\}}, \quad\text{where} 
\end{equation}

\begin{equation}
  \mathbf{1}\{\cdot\} =
  \begin{cases}
  1 & \text{if individual } i \text{ is eligible but does not take up BAföG}, \\
  0 & \text{otherwise}.
  \end{cases}
\label{eq:indicator-function-ntu}
\end{equation}


\paragraph{Beta Error (Type II Error).}  
It is worth noting, however, that these situations are often more complex. 
In some cases, individuals may receive BAföG even though they are not eligible. 
This can occur due to fraud or simply as a result of administrative errors. 
Such cases introduce the concept of beta errors. 
A beta error refers to the probability that a student receives BAföG despite being classified as ineligible by our model. 
It captures false positives in the eligibility classification; cases where students who should not qualify according to the simulation nonetheless receive financial support.

Formally, it is expressed as:
\begin{equation}
\Pr(\text{TU} = 1 \mid M = 0) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 1 \ \text{and} \ M_i = 0\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 0\}},
\end{equation}
where \( \mathbf{1}\{\cdot\} \) is the indicator function defined as
\[
\mathbf{1}\{\cdot\} =
\begin{cases}
1 & \text{if individual } i \text{ is ineligible but receives BAföG}, \\
0 & \text{otherwise}.
\end{cases}
\]

% Maybe ref all our data sources, the statutory and soep
\subsubsection{Simulation Pipeline}
The pipeline begins by assembling a harmonized dataset of student-level observations from SOEP-Core and manually harmonizing variables which are not harmonized already.
This is achieved by filtering for individuals who are enrolled in education, fall within the relevant survey years, and are at least 18 years old. 
To ensure a valid estimation of parental contributions, the dataset is further restricted to cases where income data from both legal parents are observable in the panel in order to reduce bias and ensure validity of estimated parental contributions.

The resulting student-level dataframe integrates sociodemographic variables including sex, age, partnership status, number of siblings, number of children, household composition, and federal state of residence. 
Gross student income is also appended at this stage. 
Net student income is derived from gross values by applying year-specific rules for income tax, solidarity surcharge, church tax (where applicable), and standard deductions (e.g., Werbungskostenpauschale), in accordance with §§\,21–23 BAföG \citep{bafoeg_law}.
This net income will later be used to compute the student’s excess income as part of the BAföG need assessment.

\paragraph{Need calculation and theoretical entitlement.}
In the final stage, the simulation model calculates the student's funding need by summing the statutory base need, housing allowance, and health insurance supplement, as defined in §\,13 BAföG \citep{bafoeg_law}. 
From this total, the model subtracts any excess income attributable to the student, their parents, and their assets. 
The resulting amount determines the theoretical monthly BAföG entitlement.

A positive entitlement does not automatically imply eligibility: the model also applies age-based eligibility criteria. 
Students are only considered theoretically eligible if they meet the age requirements defined in the law, typically under 30 for undergraduate studies and under 35 for graduate-level programs. 
The final output includes both the simulated monthly award and a binary eligibility flag, which are used for comparison against self-reported values in SOEP. 
Detailed examples of this calculation and relevant thresholds are provided in Appendix~\ref{appendix:simulation-example}.


\paragraph{Estimating Parental Contributions.}
Accurate parental income information is essential for constructing a credible BAföG means test. 
To ensure consistency in the simulation, the analysis is restricted to students for whom income data from both legal parents are available within the household files. 
This means that cases where one or both parents cannot be identified or linked within the dataset—such as due to absence, non-response, or household separation—are excluded from the simulation sample.

The simulation pipeline aggregates and evaluates parental income to estimate the expected contribution toward the student’s BAföG entitlement. 
For each student, the incomes of both legal parents—identified within the household and linked through SOEP family structure data—are retrieved and converted into annual net income. 
These values account for deductions such as income tax, solidarity surcharge, and church tax, where applicable.

Net incomes from both parents are combined into a joint parental income measure. 
From this, the model subtracts statutory allowances as defined in §§\,24–25 BAföG \citep{bafoeg_law}, which vary depending on the number of parents, number of dependent children, and year-specific legal thresholds. 
Additional deductions are applied if the student has siblings who might also be eligible for support. 
The result is a measure of excess parental income, which feeds directly into the theoretical award calculation in the next stage.

A complete breakdown of the income transformation, applicable thresholds, and illustrative examples is provided in Appendix~\ref{appendix:simulation-example}.

\paragraph{Asset Test.}
SOEP collects asset data only every five years, with available data for the years 2007, 2012, 2017, and 2022. 
This results in missing information for the intermediate survey waves. 
To address this, we imputed missing asset values using linear interpolation in both directions. 
While more advanced imputation methods exist, linear interpolation offers a straightforward and reasonable approach to create a continuous asset measure for the microsimulation.

The simulation includes an asset test to assess whether students hold financial resources above the statutory exemption thresholds. 
For each student, information on financial assets, real estate, business holdings, private insurances, vehicles, and other tangible property is combined, and reported debts are subtracted to derive total net assets.

Since asset data in SOEP are only collected every five years, missing observations for non-surveyed years are filled using linear interpolation. 
This approach allows for year-specific asset estimates that remain consistent with observed data and ensures full coverage across the entire simulation period.

Total assets are then compared against exemption thresholds defined in §\,29 BAföG \citep{bafoeg_law}, which vary by age, partnership status, and number of dependent children. 
Any amount exceeding the applicable allowance is classified as excess assets and contributes to reducing the student's calculated need. 

\paragraph{Modelling taxes.}
Full tax‑return simulations, as in \cite{herber_non-take-up_2019}, require detailed information (e.\,g.\ deductions, extraordinary expenses) that the SOEP does not always provide.  
We therefore approximate net parental income with the statutory bracket formulas of §\,32a EStG—updated for every year since 2002 
\textcolor{red}{WHY SAY 2002 IF WE ARE LOOKING AT 2007-2021?} \citep{estg_law,estg_2025,estg_2024,estg_2023,estg_2022,estg_2021,estg_2020,estg_2019,estg_2018,estg_2017,estg_2016,estg_2015,estg_2014,estg_2013,estg_2012,estg_2007,estg_2006,estg_lohninfo_2012}.  

\textcolor{red}{In our analysis, we compute individual net income for students (as well as their parents, partners and siblings where relevant) by applying relevant tax and transfer rules to each person’s reported gross income. We then simulate deductions such as income tax and social security contributions, which allows us to estimate net income in a consistent way, taking into account both personal characteristics and the policy environment in each year.}

\textcolor{red}{I think there is a term for this in microsimulation literature, add it here for clarification}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Binary Choice Model of Non-Take-Up
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Binary Choice Model}

To study the determinants of non-take-up (NTU) of BAföG among theoretically eligible students, we estimate a binary choice model of the form
\begin{equation}
  \Pr(\mathrm{NTU} = 1 \mid \mathbf{X}) = F(\mathbf{X}^\top \boldsymbol{\beta}),
\end{equation}
where \( \mathrm{NTU} \) is a binary indicator for non-take-up, \( \mathbf{X} \) is the vector of covariates listed in Table~\ref{tab:descriptive_ntu_all}, and \( F(\cdot) \) is a link function that maps the linear index to a probability.\footnote{
This formulation can be motivated by a latent variable model: \( \mathrm{NTU}^* = \mathbf{X}^\top \boldsymbol{\beta} + \varepsilon \), where \( \mathrm{NTU}^* \) is an unobserved continuous variable and \( \varepsilon \) follows a standard normal distribution (probit) or a logistic distribution (logit). The observed binary outcome is \( \mathrm{NTU} = 1 \) if \( \mathrm{NTU}^* > 0 \), and \( \mathrm{NTU} = 0 \) otherwise.
}

We consider three specifications for \( F(\cdot) \), corresponding to commonly used binary choice models. 
The Probit model uses the cumulative distribution function (CDF) of the standard normal distribution, the Logit model uses the CDF of the standard logistic distribution, and the Linear Probability Model (LPM) uses a linear functional form.

\begin{table}[H]
\footnotesize
\centering
\label{tab:model_specifications}
\begin{tabular}{@{}lll@{}}
\toprule
\textbf{Model} & \textbf{Link Function \( F(\mathbf{X}^\top \boldsymbol{\beta}) \)} & \textbf{Estimation Method} \\ \midrule
Probit (Standard Normal CDF) & \( \Phi(\mathbf{X}^\top \boldsymbol{\beta}) \) & Maximum Likelihood \\
Logit (Standard Logistic CDF) & \( \Lambda(\mathbf{X}^\top \boldsymbol{\beta}) \) & Maximum Likelihood \\
Linear Probability Model & \( \mathbf{X}^\top \boldsymbol{\beta} \) & Ordinary Least Squares (OLS) \\
\bottomrule
\end{tabular}
\caption{Specifications of the Binary Choice Models}
\end{table}

All models are estimated on a pooled cross-section of theoretically eligible individuals (\( n = 458 \)), as we restrict the sample to observations with complete parental income information. 
Although the SOEP is a panel, we do not exploit its longitudinal structure here due to the limited sample size.

\paragraph{Interpretation and Comparison.} 
The logit and probit models are nonlinear estimators of the probability of non-take-up, based on an underlying latent index framework. 
Their coefficients represent changes in the unobserved latent variable and are not directly interpretable in terms of changes in the probability of the observed outcome. 
To facilitate interpretation, we report average marginal effects (AMEs), which approximate the average change in the probability of non-take-up associated with a one-unit increase in each covariate.\footnote{The AME for covariate \( X_k \) is computed as the sample analogue of the population moment \( \mathbb{E}[f(\mathbf{X}^\top \boldsymbol{\beta}) \cdot \beta_k] \), where \( f(\cdot) \) is the derivative of the link function \( F(\cdot) \). Specifically,
\[
    \widehat{\text{AME}}_k 
    = \frac{1}{n} \sum_{i=1}^n f(\mathbf{X}_i^\top \hat{\boldsymbol{\beta}}) \cdot \hat{\beta}_k
    = \mathbb{E}_n \left[ f(\mathbf{X}^\top \hat{\boldsymbol{\beta}}) \cdot \hat{\beta}_k \right],
\]
where \( \mathbb{E}_n[\cdot] \) denotes the empirical expectation over the sample.}

In practice, logit and probit models typically yield similar qualitative results, with differences largely driven by the tails of the distribution. We report both for completeness.

The LPM serves as a linear benchmark. 
While it can produce predicted probabilities outside the \([0,1]\) range and has some limitations in modelling binary outcomes, it provides a simple and transparent interpretation as coefficients directly represents the marginal effects.

\subsubsection{Key Predictors of Non-Take-Up}
Our model includes a set of explanatory variables informed by existing literature and the institutional context of BAföG. 
These variables capture a range of factors that may influence students' decisions about applying for financial aid, including demographic characteristics, socioeconomic background, and selected behavioural traits. 
In particular, we incorporate variables such as risk preferences, migration background, and prior family experience with BAföG to reflect differences in access to information, attitudes toward borrowing, and familiarity with the application process. 
While our primary goal is to estimate the association between these factors and non-take-up among eligible students, the inclusion of conceptually relevant variables also helps to account for sources of heterogeneity that might otherwise bias the estimated effects of financial incentives.

The rationale for including several of these variables is further elaborated below, drawing on prior research and theoretical considerations. In particular, the inclusion of factors like risk attitudes, family experience with the application process, and regional socialization helps account for variation in informational access, institutional trust, and attitudes toward public support.

\paragraph{Risk appetite, impulsiveness and patience.}  
To understand why some eligible students don’t apply for BAföG, we consider their willingness to take risks.  
Even though BAföG comes with relatively safe and generous terms, risk-averse students might still shy away from taking on any debt.  
By including this measure, we aim to see if risk preferences explain some of the non-take-up behaviour.  

\cite{herber_non-take-up_2019} also control for risk attitudes in their study, mainly to check if risk aversion influences take-up or interacts with traits like impatience.  
While they find no strong effect, they argue it’s important to keep it in the model — and we follow their lead here.  

Alongside risk appetite, we account for impulsiveness and patience using scales constructed by SOEP based on several survey questions.  
These behavioural traits might shape how students make financial decisions, so including them helps capture more of the individual variation behind BAföG take-up.

\paragraph{East German socialisation.}  
Whether a student lives in East Germany could shape their attitudes toward state support, reflecting historical and cultural influences.  
Research by \cite{alesina_good-bye_2007} shows that former GDR residents tend to favour redistribution more and trust state support even generations after reunification.  
So, we use this regional indicator as a proxy for such socialisation effects.  
Since it turns out significant in our model, it likely captures meaningful differences in how students view and respond to BAföG.

\paragraph{Sibling prior experience with BAföG.}  
Having an older sibling who previously received BAföG might ease the application process by providing guidance and familiarity.  
According to Herber et al. (2019), this kind of family experience can lower informational and procedural barriers, making it easier for students to follow through.  
Including this factor helps us see if such informal support within families influences take-up decisions.

\paragraph{Migration background.}  
We distinguish between direct and indirect migration backgrounds to explore whether less familiarity with the German aid system affects take-up.  
Students from migrant households might face additional challenges understanding eligibility or navigating the application, partly due to lower financial literacy documented in recent studies \citep{Tsegay_2024}.  
Accounting for migration background helps us uncover structural or informational hurdles that could contribute to lower BAföG uptake.

\paragraph{Parental education.}  
Parental education often shapes students’ educational and financial behaviours.  
We flag students whose parents hold at least a bachelor’s degree as coming from higher-educated households to test whether this background affects BAföG application patterns.

\paragraph{Siblings who have claimed BAföG.}  
Beyond older siblings, any sibling with prior BAföG experience could provide valuable insights or encouragement.  
This variable lets us check if broader family exposure to BAföG matters.

\paragraph{Age, sex, and partnership status.}  
Finally, we control for basic demographics that may influence financial aid decisions.  
Age reflects where students are in their studies or life course, which can change their financial needs or familiarity with administrative procedures.  
Sex (female) captures potential gender-related differences in financial choices or access to information.  
And partnership status accounts for how having a partner might affect household resources, financial planning, or information sharing relevant to BAföG take-up.

% By controlling for these demographic characteristics, we aim to ensure that our analysis more accurately isolates the effects of other variables of interest.



\subsection{Model limitations}
\label{subsection:model_limitations}

\textcolor{red}{Alex: I moved limitations to here. We need to look into what limitations are relevant. We are undermining our model too much still.}

\paragraph{Addressing beta errors in eligibility simulations.}
In simulating benefit non-take-up, beta errors occur when individuals report receiving a benefit but are classified by the model as ineligible. 
These mismatches typically reflect limitations in the input data, particularly income and assets.
Since the data in this study is self-reported, inaccuracies may occur in both income and benefit receipt.
Without administrative records, it is not possible to confirm whether a student was truly eligible or actually received the benefit. 
Some studies suggest that beta errors are more often caused by issues in the income or asset data used for eligibility simulation, rather than incorrect reporting of benefit receipt \citep{frick_claim_2007, janssens_takemod_2022}. 

To address these limitations, several strategies are used in the literature. 
These include conducting sensitivity checks by adjusting income levels and applying post-simulation corrections to reclassify borderline cases \citep{herber_non-take-up_2019}. 
Some studies also emphasize the value of combining different data sources where possible, such as using more detailed survey modules on assets or household composition to improve the accuracy of eligibility simulations \citep{janssens_takemod_2022}. 

Although beta errors cannot be completely avoided, it is important to recognise their potential impact on the results. 
In this thesis, particular attention is paid to identifying where beta errors may occur and considering how they might influence the findings. 
Sensitivity checks are applied where relevant to assess the robustness of the findings and to reduce the risk of misinterpretation. %TODO: No no sensitivity checks are applied so far.

\paragraph{Measurement Errors in Income Data}
A persistent challenge in empirical research is the presence of measurement errors in income data, which can bias the estimation of policy outcomes. 
In the context of our study, accurate measurement of both parental and student incomes is crucial, as these variables are the primary determinants of the theoretical BAföG entitlement to be calculated.

To assess the impact of potential income misreporting or data imperfections, we conduct a sensitivity analysis by introducing normally distributed noise to the log-transformed income variables. 
Logging is applied to address the right-skewness in the income distributions (see Figure~\ref{fig:income-distributions}). 
By simulating random measurement errors in logged income, we can evaluate how such noise affects the estimated non-take-up rates and the reliability (i.e., beta errors) of the simulation outcomes.

This approach allows us to better understand the robustness of our results to plausible inaccuracies in income reporting, and highlights the importance of data quality in studies of means-tested student aid.

\paragraph{Income misreporting.}
When studying benefit take-up using a probit model, there are two common sources of bias that are important to keep in mind: measurement error in income and incorrect reporting of benefit receipt. Income is a key factor in determining eligibility for means-tested programs like BAföG, but it is often self-reported and can be measured with error. If the income recorded in the data does not reflect individuals' true income, some people may be wrongly classified as eligible or ineligible. This can lead to biased estimates and misleading conclusions about the factors that influence take-up \citep{pudney_impact_2001}.

\paragraph{Take-up misreporting.} Another issue is that benefit receipt itself is sometimes misreported. For example, people might say they did not receive aid when they actually did, or the other way around. This kind of misclassification makes it harder to accurately model the take-up decision. As shown in \cite{pudney_impact_2001}, even relatively small errors in either income or benefit receipt can have a big impact on the results. This highlights the importance of being aware of potential measurement problems when interpreting the findings from probit models.


