%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% METHOD
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%TODO: Maybe reference table A1 in appendix, conditional per different types.
%TODO: Not mentioned how we dealt with measurement errors
%TODO: Did you compare simulated eligibility rates with official BAföG statistics?
%TODO: We need to do sensitivity analysis 
%TODO: How closely do simulated award amounts match reported distributions? Use appendix distribution
%TODO: Also use timeline in appendix for the comparison of theoretical to reported

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Method} 
This study proceeds in two main steps. 
First, we perform a microsimulation to calculate theoretical BAföG eligibility and award amounts based on statutory rules applied to individual-level survey data. 
This simulation serves to identify who is entitled to student aid under the legal framework. Microsimulation is particularly suited here because it accounts for individual differences in backgrounds and family situations, applying complex eligibility rules precisely.

Second, we estimate two binary response models along with a linear probability model to analyze behavioural non-take-up.
That is, the likelihood that students eligible for BAföG according to the simulation nonetheless do not receive it. 
These models incorporate relevant socioeconomic and demographic factors to explore determinants of non-take-up beyond eligibility alone.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Microsimulation
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Microsimulation of Theoretical BAföG Eligibility} 
To analyze non-take-up, we identify eligible students based on statutory criteria, regardless of actual receipt.
We implement a microsimulation model that reconstructs individual eligibility and award amounts using detailed SOEP survey data and the relevant legal rules.
The following section outlines the purpose, methodological approach, and main components of this simulation. 
For an overview of the approach see Figure \ref{fig:pipeline-overview}.

\input{tikzfigs/simulation_algo.tex}

% \subsubsection{Purpose and Scope}
The microsimulation pipeline is designed to calculate a theoretical BAföG eligibility status and award amount for students in the SOEP-Core sample. Its primary purpose is to compare these simulated entitlements with reported BAföG take-up, as reported in SOEP.

To construct the theoretical values, the model replicates the legal rules and means-testing procedures defined in BAföG 
\citep{bafoeg_law} for the years 2007 to 2021. 
These rules are applied to individual-level SOEP data, including detailed information on income, assets, housing costs, and household structure.

In contrast to some earlier studies, we focus exclusively on students in higher education and restrict our sample to individuals aged 18 and older. This choice is motivated by a combination of conceptual, practical, and policy-relevant considerations. From a conceptual standpoint, the structure and goals of BAföG can differ between higher education and vocational training, including differences in eligibility criteria, typical household circumstances, and expectations around study duration and labor market transitions. Focusing only on higher education students allows for a more consistent definition of the target population.

Practically, focusing on students aged 18 and older ensures that key variables needed for the simulation, such as income, employment, and assets, are consistently available at the individual level. SOEP collects this information directly only for adult respondents. For individuals under 18, many of these variables are either missing, incomplete, or recorded via proxy responses from parents \citep{soep_pgen_2025, soep_dtc_2005}. Restricting the sample in this way helps improve both consistency and the reliability of the eligibility estimates, since information on key variables is more reliably reported for this group in SOEP. 

From a policy perspective, university students are more frequently the focus of public debate around BAföG reform, especially in relation to issues such as debt aversion, housing costs, and equitable access to higher education. By concentrating on this group, our results are more directly applicable to ongoing policy discussions and recent reforms targeting the higher education sector.

This approach enables a systematic assessment of the alignment between statutory entitlements and actual BAföG participation. 
Deviations between the modeled and reported outcomes may arise from reporting errors, exceptional administrative decisions, or incomplete data. 
Full documentation of the simulation logic and input structure is provided in Appendix ~\ref{appendix:microsimulation-pipeline} and ~\ref{appendix:simulation-example}.

\paragraph{Deviation from official outcomes.}
Even when closely following the legal rules, the simulation can differ from actual BAföG decisions due to missing household details or unobserved individual circumstances. 
Still, it offers a consistent and transparent benchmark for analysing take-up over time.

While many SOEP variables approximate administrative data, its still the most suitable dataset for examining the BAföG non-take-up rate. 
The eligibility measure used here reflects the legal framework and is sufficiently accurate for a systematic analysis of non-take-up and its underlying factors.


\subsubsection{Identifying the Non-Take-Up Rate and Beta Error}
%TODO: Not referenced correctly
We define non-take-up of BAföG in line with Nelson and Nieuwenhuis (2019), as the circumstance when a person is eligible for welfare, but does not receive it. This is in line with terminology commonly used in literature on welfare take up rates. Non take up rate is thus the number of people who are eligible, but do not receive it, divided by the total number of people eligible. 


Formally, this is expressed as:

\begin{equation}
\Pr(\text{NTU} = 1 \mid M = 1) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 0 \ \text{and} \ M_i = 1\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 1\}}, \quad\text{where} 
\end{equation}

\begin{equation}
  \mathbf{1}\{\cdot\} =
  \begin{cases}
  1 & \text{if individual } i \text{ is eligible but does not take up BAföG}, \\
  0 & \text{otherwise}.
  \end{cases}
\label{eq:indicator-function-ntu}
\end{equation}


\paragraph{Beta Error (Type II Error).}  
It is worth noting, however, that these situations are often more complex. 
In some cases, individuals may receive BAföG even though they are not eligible. 
This can occur due to fraud or simply as a result of administrative errors. 
Such cases introduce the concept of beta errors. 
A beta error refers to the probability that a student receives BAföG despite being classified as ineligible by our model. 
It captures false positives in the eligibility classification; cases where students who should not qualify according to the simulation nonetheless receive financial support.

Formally, it is expressed as:
\begin{equation}
\Pr(\text{TU} = 1 \mid M = 0) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 1 \ \text{and} \ M_i = 0\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 0\}},
\end{equation}
where \( \mathbf{1}\{\cdot\} \) is the indicator function defined as
\[
\mathbf{1}\{\cdot\} =
\begin{cases}
1 & \text{if individual } i \text{ is ineligible but receives BAföG}, \\
0 & \text{otherwise}.
\end{cases}
\]

% Maybe ref all our data sources, the statutory and soep
\subsubsection{Simulation Pipeline}
The pipeline begins by assembling a harmonized dataset of student-level observations from SOEP-Core and manually harmonizing variables which are not harmonized already.
This is achieved by filtering for individuals who are enrolled in education, fall within the relevant survey years, and are at least 18 years old. 
To ensure a valid estimation of parental contributions, the dataset is further restricted to cases where income data from both legal parents are observable in the panel in order to reduce bias and ensure validity of estimated parental contributions.

The resulting student-level dataframe integrates sociodemographic variables including sex, age, partnership status, number of siblings, number of children, household composition, and federal state of residence. 
Gross student income is also appended at this stage. 
Net student income is derived from gross values by applying year-specific rules for income tax, solidarity surcharge, church tax (where applicable), and standard deductions (e.g., Werbungskostenpauschale), in accordance with §§\,21–23 BAföG \citep{bafoeg_law}.
This net income will later be used to compute the student’s excess income as part of the BAföG need assessment.

\paragraph{Need calculation and theoretical entitlement.}
In the final stage, the simulation model calculates the student's funding need by summing the statutory base need, housing allowance, and health insurance supplement, as defined in §\,13 BAföG \citep{bafoeg_law}. 
From this total, the model subtracts any excess income attributable to the student, their parents, and their assets. 
The resulting amount determines the theoretical monthly BAföG entitlement.

A positive entitlement does not automatically imply eligibility: the model also applies age-based eligibility criteria. 
Students are only considered theoretically eligible if they meet the age requirements defined in the law, typically under 30 for undergraduate studies and under 35 for graduate-level programs. 
The final output includes both the simulated monthly award and a binary eligibility flag, which are used for comparison against self-reported values in SOEP. 
Detailed examples of this calculation and relevant thresholds are provided in Appendix~\ref{appendix:simulation-example}.


\paragraph{Estimating Parental Contributions.}
Accurate parental income information is essential for constructing a credible BAföG means test. 
To ensure consistency in the simulation, the analysis is restricted to students for whom income data from both legal parents are available within the household files. 
This means that cases where one or both parents cannot be identified or linked within the dataset—such as due to absence, non-response, or household separation—are excluded from the simulation sample.

The simulation pipeline aggregates and evaluates parental income to estimate the expected contribution toward the student’s BAföG entitlement. 
For each student, the incomes of both legal parents—identified within the household and linked through SOEP family structure data—are retrieved and converted into annual net income. 
These values account for deductions such as income tax, solidarity surcharge, and church tax, where applicable.

Net incomes from both parents are combined into a joint parental income measure. 
From this, the model subtracts statutory allowances as defined in §§\,24–25 BAföG \citep{bafoeg_law}, which vary depending on the number of parents, number of dependent children, and year-specific legal thresholds. 
Additional deductions are applied if the student has siblings who might also be eligible for support. 
The result is a measure of excess parental income, which feeds directly into the theoretical award calculation in the next stage.

A complete breakdown of the income transformation, applicable thresholds, and illustrative examples is provided in Appendix~\ref{appendix:simulation-example}.

\paragraph{Asset Test.}
SOEP collects asset data only every five years, with available data for the years 2007, 2012, 2017, and 2022. 
This results in missing information for the intermediate survey waves. 
To address this, we imputed missing asset values using linear interpolation in both directions. 
While more advanced imputation methods exist, linear interpolation offers a straightforward and reasonable approach to create a continuous asset measure for the microsimulation.

The simulation includes an asset test to assess whether students hold financial resources above the statutory exemption thresholds. 
For each student, information on financial assets, real estate, business holdings, private insurances, vehicles, and other tangible property is combined, and reported debts are subtracted to derive total net assets.

Since asset data in SOEP are only collected every five years, missing observations for non-surveyed years are filled using linear interpolation. 
This approach allows for year-specific asset estimates that remain consistent with observed data and ensures full coverage across the entire simulation period.

Total assets are then compared against exemption thresholds defined in §\,29 BAföG \citep{bafoeg_law}, which vary by age, partnership status, and number of dependent children. 
Any amount exceeding the applicable allowance is classified as excess assets and contributes to reducing the student's calculated need. 

\paragraph{Modelling taxes.}
Full tax‑return simulations, as in \cite{herber_non-take-up_2019}, require detailed information (e.\,g.\ deductions, extraordinary expenses) that the SOEP does not always provide.  
We therefore approximate net parental income with the statutory bracket formulas of §\,32a EStG—updated for every year since 2002 
\textcolor{red}{WHY SAY 2002 IF WE ARE LOOKING AT 2007-2021?} \citep{estg_law,estg_2025,estg_2024,estg_2023,estg_2022,estg_2021,estg_2020,estg_2019,estg_2018,estg_2017,estg_2016,estg_2015,estg_2014,estg_2013,estg_2012,estg_2007,estg_2006,estg_lohninfo_2012}.  

\textcolor{red}{In our analysis, we compute individual net income for students (as well as their parents, partners and siblings where relevant) by applying relevant tax and transfer rules to each person’s reported gross income. We then simulate deductions such as income tax and social security contributions, which allows us to estimate net income in a consistent way, taking into account both personal characteristics and the policy environment in each year.}

\textcolor{red}{I think there is a term for this in microsimulation literature, add it here for clarification}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Binary Choice Model of Non-Take-Up
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Binary Choice Model}

To study the determinants of non-take-up (NTU) of BAföG among theoretically eligible students, we estimate a binary choice model of the form
\begin{equation}
  \Pr(\mathrm{NTU} = 1 \mid \mathbf{X}) = F(\mathbf{X}^\top \boldsymbol{\beta}),
\end{equation}
where \( \mathrm{NTU} \) is a binary indicator for non-take-up, \( \mathbf{X} \) is the vector of covariates listed in Table~\ref{tab:descriptive_ntu_all}, and \( F(\cdot) \) is the link function that maps the linear index to a probability.

We consider three common specifications for \( F(\cdot) \):

\begin{itemize}
  \item \textbf{Probit model:} \( F(z) = \Phi(z) \), where \( \Phi(\cdot) \) is the cumulative distribution function (CDF) of the standard normal distribution.
  \item \textbf{Logit model:} \( F(z) = \Lambda(z) = \frac{1}{1 + \exp(-z)} \), the logistic CDF.
  \item \textbf{Linear Probability Model (LPM):} \( F(z) = z \), estimated using ordinary least squares (OLS).
\end{itemize}

All models are estimated on a pooled cross-section of theoretically eligible individuals (\( n = 458 \)), as we restrict the sample to observations with complete parental income information. Although the SOEP is a panel, we do not exploit its longitudinal structure here due to the limited sample size.

\paragraph{Interpretation and Comparison.} 
The logit and probit models are nonlinear estimators of the probability of non-take-up, based on an underlying latent index framework. 
Their coefficients represent changes in the unobserved latent variable and are not directly interpretable in terms of changes in the probability of the observed outcome. 
To aid interpretation, we report average marginal effects (AMEs), which approximate the average change in the probability of non-take-up associated with a one-unit increase in each covariate.\footnote{The AME for covariate \( X_k \) is computed as the sample analogue of the population moment \( \mathbb{E}[f(\mathbf{X}^\top \boldsymbol{\beta}) \cdot \beta_k] \), where \( f(\cdot) \) is the derivative of the link function \( F(\cdot) \). Specifically,
\[
    \widehat{\text{AME}}_k 
    = \frac{1}{n} \sum_{i=1}^n f(\mathbf{X}_i^\top \hat{\boldsymbol{\beta}}) \cdot \hat{\beta}_k
    = \mathbb{E}_n \left[ f(\mathbf{X}^\top \hat{\boldsymbol{\beta}}) \cdot \hat{\beta}_k \right],
\]
where \( \mathbb{E}_n[\cdot] \) denotes the empirical expectation over the sample.}

In practice, logit and probit models typically yield similar qualitative results, with differences largely driven by the tails of the distribution. We report both for completeness and robustness.

The LPM serves as a linear benchmark. While it has known limitations (e.g., heteroskedastic errors and potentially implausible predicted probabilities), it offers transparent interpretation and is widely used in applied work. Coefficients can be interpreted directly as marginal effects, and extensions such as fixed effects or instrumental variables are straightforward to implement.


\subsubsection{Key Predictors of Non-Take-Up}
Our model includes a set of explanatory variables informed by existing literature and the institutional context of BAföG. 
These variables capture a range of factors that may influence students' decisions about applying for financial aid, including demographic characteristics, socioeconomic background, and selected behavioural traits. 
In particular, we incorporate variables such as risk preferences, migration background, and prior family experience with BAföG to reflect differences in access to information, attitudes toward borrowing, and familiarity with the application process. 
While our primary goal is to estimate the association between these factors and non-take-up among eligible students, the inclusion of conceptually relevant variables also helps to account for sources of heterogeneity that might otherwise bias the estimated effects of financial incentives.

The rationale for including several of these variables is further elaborated below, drawing on prior research and theoretical considerations. In particular, the inclusion of factors like risk attitudes, family experience with the application process, and regional socialization helps account for variation in informational access, institutional trust, and attitudes toward public support.

\paragraph{Risk appetite, impulsiveness and patience.} In this analysis, a variable for students' self-assessed willingness to take risks is included. 
Even though BAföG offers relatively safe and generous conditions, some students might still be hesitant to take on any form of debt if they are generally risk-averse. 
By including this variable, we aim to capture whether differences in individual risk preferences help explain why some eligible students choose not to apply.

\cite{herber_non-take-up_2019} also include a risk preference variable in their study, mainly to control for the possibility that risk attitudes could affect take-up behavior or influence how other factors, like impatience, play a role. 
They do not find a strong effect of risk aversion on BAföG take-up, but they still argue it is useful to control for. 
In a similar way, we include this variable to improve our model and to see whether risk aversion plays any role in students’ decisions to reject BAföG.

Furthermore, we include a control variable for impulsiveness, measured using a scale constructed by SOEP from responses to several relevant survey questions.
Similarly, we control for patience using a scale based on a different set of questions from the SOEP questionnaire.
Including these behavioral traits allows us to account for the possibility that impulsiveness or patience may influence students’ decision-making processes and thus help explain variation in BAföG take-up among eligible students.

\paragraph{East German socialization.}  A variable indicating whether the student lives in East Germany is included to account for potential differences in attitudes toward state support rooted in historical and regional context. \cite{alesina_good-bye_2007} show that individuals from the former GDR tend to have stronger preferences for redistribution and a greater belief in the role of the state in providing social services, and that these differences in preferences can persist for one to two generations after reunification. Current residence in East Germany may reflect continued exposure to these norms and institutions and can serve as a reasonable proxy for this form of socialization. Since the variable is statistically significant at the 5\% level in our model, we interpret it as capturing persistent regional differences in how students view and respond to publicly provided financial support like BAföG.

\paragraph{Sibling prior experience with BAföG.} An indicator for whether the student has an older sibling who previously received BAföG is included to capture potential differences in access to informal support and familiarity with the application process. Students with siblings who have already gone through the steps of applying may be more aware of eligibility rules and practical requirements. \cite{herber_non-take-up_2019} highlight that such sibling experience can help reduce informational and procedural barriers, making it more likely that students follow through with the application. This variable is intended to reflect how previous exposure to the system within the family can shape students’ confidence and ability to navigate what is often perceived as a complex process.

\paragraph{Migration background.} Two variable for indirect and direct migration background is included to explore whether differences in familiarity with the BAföG system may influence take-up. 
Some students may come from households with less exposure to German administrative processes or financial aid structures, which could affect their understanding of eligibility or the application itself. 
In addition, studies show that individuals with a migration background in Germany often have lower financial literacy, which may make it harder to evaluate financial aid options like BAföG \citep{Tsegay_2024}. 
Including this variable helps capture potential structural or informational factors that may contribute to lower take-up rates among eligible students. 

\paragraph{Parental education.}
To assess whether parental education influences BAföG take-up rates, we include a control variable that identifies students whose parents hold at least a bachelor’s degree as having a higher education background. 
This classification allows us to examine the potential effect of parental educational attainment on students’ likelihood of applying for and receiving BAföG support.

\paragraph{Siblings who have claimed BAföG.}
We include a control variable indicating whether any of the respondent’s siblings have previously claimed BAföG. 
The presence of a sibling with prior BAföG experience may provide informational advantages or influence the individual’s own decision-making process regarding BAföG take-up.

\paragraph{Age, sex, and partnership status.}
We include control variables for age, sex (female), and partnership status (has partner) to account for demographic factors that may influence BAföG take-up. 
Age is controlled for, as students’ likelihood of applying for financial aid may change with their stage of study or broader life circumstances. 
For instance, older students may encounter different financial pressures or possess greater familiarity with administrative processes compared to younger students.
Sex is included to capture potential gender differences in educational choices, financial decision-making, or access to information about student aid. 
Partnership status is considered, as having a partner could affect an individual’s household resources, financial planning, or the sharing of information relevant to student aid. 
By controlling for these demographic characteristics, we aim to ensure that our analysis more accurately isolates the effects of other variables of interest.



\subsection{Model limitations}
\label{subsection:model_limitations}

\textcolor{red}{Alex: I moved limitations to here. We need to look into what limitations are relevant. We are undermining our model too much still.}

\paragraph{Addressing beta errors in eligibility simulations.}
In simulating benefit non-take-up, beta errors occur when individuals report receiving a benefit but are classified by the model as ineligible. 
These mismatches typically reflect limitations in the input data, particularly income and assets.
Since the data in this study is self-reported, inaccuracies may occur in both income and benefit receipt.
Without administrative records, it is not possible to confirm whether a student was truly eligible or actually received the benefit. 
Some studies suggest that beta errors are more often caused by issues in the income or asset data used for eligibility simulation, rather than incorrect reporting of benefit receipt \citep{frick_claim_2007, janssens_takemod_2022}. 

To address these limitations, several strategies are used in the literature. 
These include conducting sensitivity checks by adjusting income levels and applying post-simulation corrections to reclassify borderline cases \citep{herber_non-take-up_2019}. 
Some studies also emphasize the value of combining different data sources where possible, such as using more detailed survey modules on assets or household composition to improve the accuracy of eligibility simulations \citep{janssens_takemod_2022}. 

Although beta errors cannot be completely avoided, it is important to recognise their potential impact on the results. 
In this thesis, particular attention is paid to identifying where beta errors may occur and considering how they might influence the findings. 
Sensitivity checks are applied where relevant to assess the robustness of the findings and to reduce the risk of misinterpretation. %TODO: No no sensitivity checks are applied so far.

\paragraph{Measurement Errors in Income Data}
A persistent challenge in empirical research is the presence of measurement errors in income data, which can bias the estimation of policy outcomes. 
In the context of our study, accurate measurement of both parental and student incomes is crucial, as these variables are the primary determinants of the theoretical BAföG entitlement to be calculated.

To assess the impact of potential income misreporting or data imperfections, we conduct a sensitivity analysis by introducing normally distributed noise to the log-transformed income variables. 
Logging is applied to address the right-skewness in the income distributions (see Figure~\ref{fig:income-distributions}). 
By simulating random measurement errors in logged income, we can evaluate how such noise affects the estimated non-take-up rates and the reliability (i.e., beta errors) of the simulation outcomes.

This approach allows us to better understand the robustness of our results to plausible inaccuracies in income reporting, and highlights the importance of data quality in studies of means-tested student aid.

\paragraph{Income misreporting.}
When studying benefit take-up using a probit model, there are two common sources of bias that are important to keep in mind: measurement error in income and incorrect reporting of benefit receipt. Income is a key factor in determining eligibility for means-tested programs like BAföG, but it is often self-reported and can be measured with error. If the income recorded in the data does not reflect individuals' true income, some people may be wrongly classified as eligible or ineligible. This can lead to biased estimates and misleading conclusions about the factors that influence take-up \citep{pudney_impact_2001}.

\paragraph{Take-up misreporting.} Another issue is that benefit receipt itself is sometimes misreported. For example, people might say they did not receive aid when they actually did, or the other way around. This kind of misclassification makes it harder to accurately model the take-up decision. As shown in \cite{pudney_impact_2001}, even relatively small errors in either income or benefit receipt can have a big impact on the results. This highlights the importance of being aware of potential measurement problems when interpreting the findings from probit models.


