\section{Method} 

MOVE THIS TEXT TO THE LITERATURE REVIEW SECTION

\paragraph{Non take up of welfare.}

We define non take up of welfare in line with Nelson and Nieuwenhuis (2019), as the circumstance when a person is eligible for welfare, but does not receive it. This is in line with terminology commonly used in literature on welfare take up rates. Non take up rate is thus the number of people who are eligible, but do not receive it, divided by the total number of people eligible. It is worth noting, however, that these situations often prove to be more complicated. In some cases, some individuals might receive welfare even though they aren’t eligible. This might for example happen due to fraud or errors made on the administrative level. This presents the issue of type two beta errors \citep{herber_non-take-up_2019, nelson_towards_2021}.

\paragraph{Tertiary non take up of welfare.}
In 2017, Van Mechelen and Janssens defined tertiary non-take-up
as a situation in which vulnerable individuals aren’t entitled to social welfare due to eligibility rules, even
if they are in need of support. Tertiary non-take up as defined here can thus be considered a specific
form of non take up. Originally, this concept was defined narrowly to include only those who are not
eligible within a vulnerable group. However, some have argued for a broader definition that includes
everyone in the vulnerable group that does not actually receive the welfare benefit, regardless of whether
they are eligible or not <\citep{mechelen_who_2017, goedeme_concept_2020}.

The concept of non-tertiary take-up relates directly to the concept of targeting efficiency, which can be
divided into vertical and horizontal efficiency. Vertical efficiency refers to how well a welfare system avoids
giving support to individuals who fall outside the intended target group. In most cases, the target group
is defined as those who are not considered economically vulnerable. It is essentially about minimising
incorrect inclusion. One way to express this is through leakage, which is defined as the proportion of
benefit recipients who are not a part of the reference population. The reference population is typically
defined as people with low living standards, low income or other markers of economic vulnerability.
In contrast, horizontal efficiency focuses on whether those within the target group actually receive the
support. If many eligible or vulnerable individuals go without welfare benefits, the system is horizontally
inefficient. This concept aligns closely with the broader definition of tertiary non-take-up, which includes
all vulnerable individuals who are unable to access support, regardless of the reason \citep{mechelen_who_2017, goedeme_concept_2020}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Method
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Microsimulation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Microsimulation of Theoretical BAföG Eligibility} 
\subsubsection{Purpose and Scope}
The microsimulation pipeline is designed to calculate a theoretical BAföG eligibility status and award amount for students in the SOEP-Core sample. 
Its primary purpose is to compare these simulated entitlements with de facto BAföG take-up, as reported in SOEP.

To construct the theoretical values, the model replicates the legal rules and means-testing procedures defined in the Bundesausbildungsförderungsgesetz (BAföG) for the years 2007 to 2021. 
These rules are applied to individual-level SOEP data, including detailed information on income, assets, housing costs, and household structure.

This approach enables a systematic assessment of the alignment between statutory entitlements and actual BAföG participation. 
Deviations between the modeled and reported outcomes may arise from reporting errors, exceptional administrative decisions, or incomplete data. 
Full documentation of the simulation logic and input structure is provided in Appendix ~\ref{appendix:microsimulation-pipeline} and ~\ref{appendix:simulation-example}.

% Maybe ref all our data sources, the statutory and soep
\subsubsection{Simulation Pipeline}

\paragraph{Constructing the Student Dataset.}
The pipeline begins by assembling a harmonized dataset of student-level observations from SOEP-Core. 
This is achieved by filtering for individuals who are enrolled in education, fall within the relevant survey years, and are at least 18 years old. 
To ensure a valid estimation of parental contributions, the dataset is further restricted to cases where income data from both legal parents are observable in the panel.

The resulting student-level dataframe integrates sociodemographic variables including sex, age, partnership status, number of siblings, number of children, household composition, and federal state of residence. 
Gross student income is also appended at this stage. 
Net student income is derived from gross values by applying year-specific rules for income tax, solidarity surcharge, church tax (where applicable), and standard deductions (e.g., Werbungskostenpauschale), in accordance with §§\,21–23 BAföG \citep{bafoeg_law}.
This net income will later be used to compute the student’s excess income as part of the BAföG need assessment.


\paragraph{Estimating Parental Contributions.}
In the next step, the simulation pipeline aggregates and evaluates parental income to estimate the expected contribution toward the student’s BAföG entitlement. 
For each student, the incomes of both legal parents—identified within the household and linked through SOEP family structure data—are retrieved and converted into annual net income. 
These values account for deductions such as income tax, solidarity surcharge, and church tax, where applicable.

Net incomes from both parents are combined into a joint parental income measure. 
From this, the model subtracts statutory allowances as defined in §§\,24–25 BAföG \citep{bafoeg_law}, which vary depending on the number of parents, number of dependent children, and year-specific legal thresholds. 
Additional deductions are applied if the student has siblings who might also be eligible for support. 
The result is a measure of excess parental income, which feeds directly into the theoretical award calculation in the next stage.

A complete breakdown of the income transformation, applicable thresholds, and illustrative examples is provided in Appendix~\ref{appendix:simulation-example}.

\paragraph{Asset Test.}
The simulation includes an asset test to assess whether students hold financial resources above the statutory exemption thresholds. 
For each student, information on financial assets, real estate, business holdings, private insurances, vehicles, and other tangible property is combined, and reported debts are subtracted to derive total net assets.

Since asset data in SOEP are only collected every five years, missing observations for non-surveyed years are filled using linear interpolation. 
This approach allows for year-specific asset estimates that remain consistent with observed data and ensures full coverage across the entire simulation period.

Total assets are then compared against exemption thresholds defined in §\,29 BAföG \citep{bafoeg_law}, which vary by age, partnership status, and number of dependent children. 
Any amount exceeding the applicable allowance is classified as excess assets and contributes to reducing the student's calculated need. 


\paragraph{Need Calculation and Theoretical Entitlement.}
In the final stage, the simulation model calculates the student's funding need by summing the statutory base need, housing allowance, and health insurance supplement, as defined in §\,13 BAföG \citep{bafoeg_law}. 
From this total, the model subtracts any excess income attributable to the student, their parents, and their assets. 
The resulting amount determines the theoretical monthly BAföG entitlement.

A positive entitlement does not automatically imply eligibility: the model also applies age-based eligibility criteria. 
Students are only considered theoretically eligible if they meet the age requirements defined in the law, typically under 30 for undergraduate studies and under 35 for graduate-level programs. 
The final output includes both the simulated monthly award and a binary eligibility flag, which are used for comparison against self-reported values in SOEP. 
Detailed examples of this calculation and relevant thresholds are provided in Appendix~\ref{appendix:simulation-example}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Econometric Modelling of Non-Take-Up
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Econometric Modelling of Non-Take-Up}
After simulating statutory eligibility, we analyse the \textit{behavioural} non-take-up: 
that is, the probability that a student refrains from taking up BAföG even though they are theoretically eligible according to our statutory microsimulation. 
Formally, we model:
\begin{equation}
  \Pr(\mathrm{NTU}_i = 1 \mid \mathbf{X}_i), \quad \text{with } T_i = 1 \text{ for all } i,
\end{equation}
where \( T_i = 1 \) indicates theoretical eligibility, and \( \mathrm{NTU}_i := \mathbf{1}\{A_i = 0\} \) is a binary indicator for non-take-up, derived from the observed take-up variable \( A_i \) in the SOEP-Core dataset.

Due to the binary nature of the dependent variable, we employ a Probit model with a standard normal link function. Specifically, we assume a latent index structure for the unobserved propensity to forego BAföG:
\begin{equation}
  \mathrm{NTU}_i^* = \mathbf{X}_i \beta + \varepsilon_i, 
  \quad 
  \varepsilon_i \sim \mathcal{N}(0,1),
\end{equation}
and observe:
\begin{equation}
  \mathrm{NTU}_i = \mathbf{1} \{ \mathrm{NTU}_i^* > 0 \}.
\end{equation}
That is, \( \mathrm{NTU}_i = 1 \) if and only if the student's latent utility for not applying exceeds zero.

This specification implies the following probability model:
\begin{equation}
  \Pr(\mathrm{NTU}_i = 1 \mid \mathbf{X}_i) = \Pr(\mathrm{NTU}_i^* > 0 \mid \mathbf{X}_i) = \Phi(\mathbf{X}_i \beta),
\end{equation}
where \( \Phi(\cdot) \) denotes the cumulative distribution function (CDF) of the standard normal distribution.

Hence, the latent-index formulation yields the conditional non-take-up probability for each student, and aligns with our empirical target:
\[
\Pr(\mathrm{NTU}_i = 1 \mid \mathbf{X}_i) = \Phi(\mathbf{X}_i \beta), \quad \text{for all } i \text{ such that } T_i = 1.
\]
The condition \( T_{i} = 1 \) restricts the dataset to students for whom the microsimulation yields positive statutory entitlement. Therefore, all the inferences pertains to this eligible sub-population whom are \textit{theoretically} (statutorily) eligible. 

The design matrix (\( \mathbf{X} \)) combines three partitions 
\begin{equation}
  \mathbf{X}_{i} = 
  \begin{bmatrix}
    \mathbf{Z}_{i} \mid \mathbf{B}_{i} \mid \mathbf{D}_{i}
  \end{bmatrix}
\end{equation}
where \( \mathbf{Z}_{i} \) (such as \textit{age, number of siblings}) contains continuous covariates, \( \mathbf{B}_{i} \) containing binary indicators (such as \textit{livings with parents})  and \( \mathbf{D}_{i} \) containing dummy vectors (such as \textit{sex, federal state, employment status}). 

The parameters are estimated by maximum likelihood (ML), and inference is conducted using heteroskedasticity-robust standard errors of the \textbf{MacKinnon and White (1985) HC2} type \citep{mackinnon_heteroskedasticity-consistent_1985}. These standard errors account for potential residual heteroskedasticity, which is common in large-scale observational panel data such as the SOEP-Core.\footnote{
We use the HC2 estimator following \citet{mackinnon_heteroskedasticity-consistent_1985}, which adjusts the residual variance by downweighting high-leverage observations. Specifically, the variance-covariance matrix of the estimator is given by:
\(
\widehat{\mathrm{Var}}(\hat{\beta}) = (X^\top X)^{-1} X^\top \operatorname{diag}\left( \frac{e_i^2}{1 - h_{ii}} \right) X (X^\top X)^{-1},
\)
where \( e_i \) are the residuals and \( h_{ii} \) are the diagonal elements of the hat matrix \( H = X(X^\top X)^{-1}X^\top \). This choice is motivated by \citet{chesher_hajek_1989} and \citet[Section 4]{chesher_finite-sample_1991}, who show that HC2 might be better as HC3 tends to be upward biased and HC1 downwards-biased.
}

% What is meant by latent index?
As raw Probit coefficients represents shifts in the latent index\footnote{
With the latent index we refer to the continuous "score" which drives the true/false decision, but is not itself observed. That is the unseen propensity that the model assumes sits underneath every given binary outcome.
}
and are not directly comparable across covariates. To make these comparable, we report the average marginal effects (AMEs) in the results section. This translates the covariate changes into percentage-point differences in the non-take-up probability of the individuals.


