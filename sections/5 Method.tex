%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% METHOD
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%TODO: Maybe reference table A1 in appendix, conditional per different types.
%TODO: Not mentioned how we dealt with measurement errors
%TODO: Did you compare simulated eligibility rates with official BAföG statistics?
%TODO: We need to do sensitivity analysis 
%TODO: How closely do simulated award amounts match reported distributions? Use appendix distribution
%TODO: Also use timeline in appendix for the comparison of theoretical to reported

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Method} 

\textcolor{red}{"Brief introductory paragraph clarifying why microsimulation is uniquely suited for this analysis would strengthen this section."}

This study proceeds in two main steps. 
First, we perform a microsimulation to calculate theoretical BAföG eligibility and award amounts based on statutory rules applied to individual-level survey data. 
This simulation serves to identify who should be entitled to student aid under the legal framework.

Second, we estimate binary choice models (Logit and Probit) to analyze behavioural non-take-up. 
That is, the likelihood that students eligible for BAföG according to the simulation nonetheless do not receive it. 
These models incorporate relevant socioeconomic and demographic factors to explore determinants of non-take-up beyond eligibility alone.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Microsimulation
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Microsimulation of Theoretical BAföG Eligibility} 
To analyze non-take-up of BAföG, it is necessary to identify students who would be eligible for support based on statutory criteria, regardless of whether they actually apply or receive benefits. 
To this end, we implement a microsimulation model that reconstructs individual eligibility and award amounts using detailed SOEP survey data and the relevant legal rules.
The following section outlines the purpose, methodological approach, and main components of this simulation. 
For an overview of the approach see Figure \ref{fig:pipeline-overview}.

\subsubsection{Purpose and Scope}
The microsimulation pipeline is designed to calculate a theoretical BAföG eligibility status and award amount for students in the SOEP-Core sample. 
Its primary purpose is to compare these simulated entitlements with reported BAföG take-up, as reported in SOEP.

To construct the theoretical values, the model replicates the legal rules and means-testing procedures defined in the Bundesausbildungsförderungsgesetz (BAföG) for the years 2007 to 2021. 
These rules are applied to individual-level SOEP data, including detailed information on income, assets, housing costs, and household structure.

This approach enables a systematic assessment of the alignment between statutory entitlements and actual BAföG participation. 
Deviations between the modeled and reported outcomes may arise from reporting errors, exceptional administrative decisions, or incomplete data. 
Full documentation of the simulation logic and input structure is provided in Appendix ~\ref{appendix:microsimulation-pipeline} and ~\ref{appendix:simulation-example}.

\paragraph{Identifying the Non-Take-Up (NTU) Rate and Beta Error.} %TODO: Not referenced correctly
We define non-take-up of BAföG in line with Nelson and Nieuwenhuis (2019), as the circumstance when a person is eligible for welfare, but does not receive it. This is in line with terminology commonly used in literature on welfare take up rates. Non take up rate is thus the number of people who are eligible, but do not receive it, divided by the total number of people eligible. 


Formally, this is expressed as:

\begin{equation}
\Pr(\text{NTU} = 1 \mid M = 1) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 0 \ \text{and} \ M_i = 1\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 1\}}, \quad\text{where} 
\end{equation}

\begin{equation}
  \mathbf{1}\{\cdot\} =
  \begin{cases}
  1 & \text{if individual } i \text{ is eligible but does not take up BAföG}, \\
  0 & \text{otherwise}.
  \end{cases}
\label{eq:indicator-function-ntu}
\end{equation}


\paragraph{Beta Error (Type II Error).}  
It is worth noting, however, that these situations are often more complex. 
In some cases, individuals may receive BAföG even though they are not eligible. 
This can occur due to fraud or simply as a result of administrative errors. 
Such cases introduce the concept of beta errors. 
A beta error refers to the probability that a student receives BAföG despite being classified as ineligible by our model. 
It captures false positives in the eligibility classification; cases where students who should not qualify according to the simulation nonetheless receive financial support.

Formally, it is expressed as:
\begin{equation}
\Pr(\text{TU} = 1 \mid M = 0) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 1 \ \text{and} \ M_i = 0\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 0\}},
\end{equation}
where \( \mathbf{1}\{\cdot\} \) is the indicator function defined as
\[
\mathbf{1}\{\cdot\} =
\begin{cases}
1 & \text{if individual } i \text{ is ineligible but receives BAföG}, \\
0 & \text{otherwise}.
\end{cases}
\]

% Maybe ref all our data sources, the statutory and soep
\subsubsection{Simulation Pipeline}

\paragraph{Constructing the Student Dataset.}
The pipeline begins by assembling a harmonized dataset of student-level observations from SOEP-Core and manually harmonizing variables which are not harmonized already.
This is achieved by filtering for individuals who are enrolled in education, fall within the relevant survey years, and are at least 18 years old. 
To ensure a valid estimation of parental contributions, the dataset is further restricted to cases where income data from both legal parents are observable in the panel in order to reduce bias and ensure validity of estimated parental contributions.

The resulting student-level dataframe integrates sociodemographic variables including sex, age, partnership status, number of siblings, number of children, household composition, and federal state of residence. 
Gross student income is also appended at this stage. 
Net student income is derived from gross values by applying year-specific rules for income tax, solidarity surcharge, church tax (where applicable), and standard deductions (e.g., Werbungskostenpauschale), in accordance with §§\,21–23 BAföG \citep{bafoeg_law}.
This net income will later be used to compute the student’s excess income as part of the BAföG need assessment.


\paragraph{Estimating Parental Contributions.}
In the next step, the simulation pipeline aggregates and evaluates parental income to estimate the expected contribution toward the student’s BAföG entitlement. 
For each student, the incomes of both legal parents—identified within the household and linked through SOEP family structure data—are retrieved and converted into annual net income. 
These values account for deductions such as income tax, solidarity surcharge, and church tax, where applicable.

Net incomes from both parents are combined into a joint parental income measure. 
From this, the model subtracts statutory allowances as defined in §§\,24–25 BAföG \citep{bafoeg_law}, which vary depending on the number of parents, number of dependent children, and year-specific legal thresholds. 
Additional deductions are applied if the student has siblings who might also be eligible for support. 
The result is a measure of excess parental income, which feeds directly into the theoretical award calculation in the next stage.

A complete breakdown of the income transformation, applicable thresholds, and illustrative examples is provided in Appendix~\ref{appendix:simulation-example}.

\paragraph{Asset Test.}
The simulation includes an asset test to assess whether students hold financial resources above the statutory exemption thresholds. 
For each student, information on financial assets, real estate, business holdings, private insurances, vehicles, and other tangible property is combined, and reported debts are subtracted to derive total net assets.

Since asset data in SOEP are only collected every five years, missing observations for non-surveyed years are filled using linear interpolation. 
This approach allows for year-specific asset estimates that remain consistent with observed data and ensures full coverage across the entire simulation period.

Total assets are then compared against exemption thresholds defined in §\,29 BAföG \citep{bafoeg_law}, which vary by age, partnership status, and number of dependent children. 
Any amount exceeding the applicable allowance is classified as excess assets and contributes to reducing the student's calculated need. 


\paragraph{Need calculation and theoretical entitlement.}
In the final stage, the simulation model calculates the student's funding need by summing the statutory base need, housing allowance, and health insurance supplement, as defined in §\,13 BAföG \citep{bafoeg_law}. 
From this total, the model subtracts any excess income attributable to the student, their parents, and their assets. 
The resulting amount determines the theoretical monthly BAföG entitlement.

A positive entitlement does not automatically imply eligibility: the model also applies age-based eligibility criteria. 
Students are only considered theoretically eligible if they meet the age requirements defined in the law, typically under 30 for undergraduate studies and under 35 for graduate-level programs. 
The final output includes both the simulated monthly award and a binary eligibility flag, which are used for comparison against self-reported values in SOEP. 
Detailed examples of this calculation and relevant thresholds are provided in Appendix~\ref{appendix:simulation-example}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Binary Choice Model of Non-Take-Up
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Binary Choice Model}
This section presents results from logit, probit, and linear probability model (LPM) estimations. 
Due to the relatively small sample size (\( n = 5{,}889 \)), resulting from restricting the sample to observations with complete parental income information, all models are estimated using a pooled cross-sectional specification. 
That is, we treat all available years as a single pooled sample and do not exploit the panel structure of the SOEP.

\textcolor{red}{"Consider clarifying rationale for selecting both Probit and Logit models explicitly."}

\textcolor{red}{"Mention clearly the expected differences between Logit and Probit results (usually negligible but worth stating explicitly)."}

\subsubsection{Probit Model}
Formally, we model
\begin{equation}
  \Pr(\mathrm{NTU}_i = 1 \mid \mathbf{X}_i) = \Phi(\mathbf{X}^\top \boldsymbol{\beta})
  , \qquad \text{for all } i \text{ with } T_i = 1,
\end{equation}
where \( \Phi(\cdot) \) denotes the cumulative distribution function of the standard normal distribution. 
\begin{equation}
  \Phi(z) = \int_{-\infty}^{z} \frac{1}{\sqrt{2\pi}} \exp\left( -\frac{t^2}{2} \right) \, dt
\end{equation}

Here, \( T_i = 1 \) indicates the theoretical eligibility outcome of our microsimulation, and \( \mathrm{NTU}_i := \mathbf{1}\{R_i = 0\} \) is a binary indicator for non-take-up, based on the observed receipt in SOEP-Core (with \( R_i = 1 \) indicating receipt of BAföG and \( R_i = 0 \) otherwise).

\subsubsection{Logit Model}
In the same way as the Probit model, we fit a Logit model
\begin{equation}
  \Pr(\mathrm{NTU}_i = 1 \mid \mathbf{X}_i) = \Lambda(\mathbf{X}^\top \boldsymbol{\beta})
  , \qquad \text{for all } i \text{ with } T_i = 1,
\end{equation}
where \( \Lambda(\cdot) \) denotes the logistic cumulative distribution function
\begin{equation}
  \Lambda(z) = \frac{1}{1 + \exp(-z)}.
\end{equation}

\paragraph{Interpretation.} %TODO: Maybe explain latent index more -- don't fully understand atm
Since raw logit and probit coefficients reflect changes in the latent index and are not directly interpretable in terms of outcome probabilities, we report average marginal effects (AMEs) for all covariates. These AMEs quantify the average change in the probability of non-take-up associated with a one-unit change in each covariate, holding other variables at their observed values.


\subsubsection{Linear Probability Model}
Analogously, the linear probability model (LPM) specifies a linear relationship between the covariates and the probability of non-take-up:
\begin{equation}
  \Pr(\mathrm{NTU}_i = 1 \mid \mathbf{X}_i) = \mathbf{X}_i^\top \boldsymbol{\beta}
  , \qquad \text{for all } i \text{ with } T_i = 1,
\end{equation}
where, as before, \( \mathbf{X}_i \) denotes the vector of covariates for individual \( i \), and \( \boldsymbol{\beta} \) is the vector of estimated coefficients.

Estimation is performed via ordinary least squares (OLS), clustering standard errors at the student level. 
Unlike the probit and logit models, the LPM does not constrain predicted probabilities to the interval \([0,1]\), but its coefficients are directly interpretable as approximate marginal effects.

Despite its limitations, the LPM is commonly used in applied work due to its simplicity, transparency, and computational efficiency. In particular, it provides straightforward coefficient interpretation and is easily extended to models with fixed effects or instrumental variables. Moreover, when the primary interest lies in estimating average marginal effects rather than modeling the full distribution of probabilities, the LPM often yields results that are qualitatively similar to those from non-linear models.

For this reason, we include the LPM as a useful benchmark alongside the logit and probit specifications.



\subsubsection{Control Variables}
Our models include a set of control variables to account for observed heterogeneity that may influence the probability of non-take-up. 
These controls include demographic factors (e.g., sex, migration background, partnership status, living situation), socioeconomic characteristics (e.g., parental income, own income, parental education), and family context (e.g., sibling previously claimed BAföG). 
We also control for regional differences using an East/West Germany background indicator, reflecting known structural and cultural variations. 
Finally, to capture behavioral differences that might affect take-up decisions, we include a measure of individual risk appetite. 
These covariates help isolate the association between key predictors and non-take-up by adjusting for potential confounders.

The rationale for including several of these variables is further elaborated below, drawing on prior research and theoretical considerations. In particular, the inclusion of factors like risk attitudes, family experience with the application process, and regional socialization helps account for variation in informational access, institutional trust, and attitudes toward public support.

\paragraph{Risk appetite, impulsiveness and patience.} In this analysis, a variable for students' self-assessed willingness to take risks is included. 
Even though BAföG offers relatively safe and generous conditions, some students might still be hesitant to take on any form of debt if they are generally risk-averse. 
By including this variable, we aim to capture whether differences in individual risk preferences help explain why some eligible students choose not to apply.

\cite{herber_non-take-up_2019} also include a risk preference variable in their study, mainly to control for the possibility that risk attitudes could affect take-up behavior or influence how other factors, like impatience, play a role. 
They do not find a strong effect of risk aversion on BAföG take-up, but they still argue it is useful to control for. 
In a similar way, we include this variable to improve our model and to see whether risk aversion plays any role in students’ decisions to reject BAföG.

Furthermore, we include a control variable for impulsiveness, measured using a scale constructed by SOEP from responses to several relevant survey questions.
Similarly, we control for patience using a scale based on a different set of questions from the SOEP questionnaire.
Including these behavioral traits allows us to account for the possibility that impulsiveness or patience may influence students’ decision-making processes and thus help explain variation in BAföG take-up among eligible students.

\paragraph{East German socialization.}  A variable indicating whether the student lives in East Germany is included to account for potential differences in attitudes toward state support rooted in historical and regional context. \cite{alesina_good-bye_2007} show that individuals from the former GDR tend to have stronger preferences for redistribution and a greater belief in the role of the state in providing social services, and that these differences in preferences can persist for one to two generations after reunification. Current residence in East Germany may reflect continued exposure to these norms and institutions and can serve as a reasonable proxy for this form of socialization. Since the variable is statistically significant at the 5\% level in our model, we interpret it as capturing persistent regional differences in how students view and respond to publicly provided financial support like BAföG.

\paragraph{Sibling prior experience with BAföG.} An indicator for whether the student has an older sibling who previously received BAföG is included to capture potential differences in access to informal support and familiarity with the application process. Students with siblings who have already gone through the steps of applying may be more aware of eligibility rules and practical requirements. \cite{herber_non-take-up_2019} highlight that such sibling experience can help reduce informational and procedural barriers, making it more likely that students follow through with the application. This variable is intended to reflect how previous exposure to the system within the family can shape students’ confidence and ability to navigate what is often perceived as a complex process.

\paragraph{Migration background.} Two variable for indirect and direct migration background is included to explore whether differences in familiarity with the BAföG system may influence take-up. 
Some students may come from households with less exposure to German administrative processes or financial aid structures, which could affect their understanding of eligibility or the application itself. 
In addition, studies show that individuals with a migration background in Germany often have lower financial literacy, which may make it harder to evaluate financial aid options like BAföG \citep{Tsegay_2024}. 
Including this variable helps capture potential structural or informational factors that may contribute to lower take-up rates among eligible students. 

\paragraph{Parental education.}
To assess whether parental education influences BAföG take-up rates, we include a control variable that identifies students whose parents hold at least a bachelor’s degree as having a higher education background. 
This classification allows us to examine the potential effect of parental educational attainment on students’ likelihood of applying for and receiving BAföG support.

\paragraph{Siblings who have claimed BAföG.}
We include a control variable indicating whether any of the respondent’s siblings have previously claimed BAföG. 
The presence of a sibling with prior BAföG experience may provide informational advantages or influence the individual’s own decision-making process regarding BAföG take-up.

\paragraph{Age, Sex, and Partnership Status.}
We include control variables for age, sex (female), and partnership status (has partner) to account for demographic factors that may influence BAföG take-up. 
Age is controlled for, as students’ likelihood of applying for financial aid may change with their stage of study or broader life circumstances. 
For instance, older students may encounter different financial pressures or possess greater familiarity with administrative processes compared to younger students.
Sex is included to capture potential gender differences in educational choices, financial decision-making, or access to information about student aid. 
Partnership status is considered, as having a partner could affect an individual’s household resources, financial planning, or the sharing of information relevant to student aid. 
By controlling for these demographic characteristics, we aim to ensure that our analysis more accurately isolates the effects of other variables of interest.



\subsection{Model limitations}
\label{subsection:model_limitations}

\textcolor{red}{Are we also repeating ourselves here?}

\paragraph{Addressing beta errors in eligibility simulations.}
In simulating benefit non-take-up, beta errors occur when individuals report receiving a benefit but are classified by the model as ineligible. 
These mismatches typically reflect limitations in the input data, particularly income and assets.
Since the data in this study is self-reported, inaccuracies may occur in both income and benefit receipt.
Without administrative records, it is not possible to confirm whether a student was truly eligible or actually received the benefit. 
Some studies suggest that beta errors are more often caused by issues in the income or asset data used for eligibility simulation, rather than incorrect reporting of benefit receipt \citep{frick_claim_2007, janssens_takemod_2022}. 

To address these limitations, several strategies are used in the literature. 
These include conducting sensitivity checks by adjusting income levels and applying post-simulation corrections to reclassify borderline cases \citep{herber_non-take-up_2019}. 
Some studies also emphasize the value of combining different data sources where possible, such as using more detailed survey modules on assets or household composition to improve the accuracy of eligibility simulations \citep{janssens_takemod_2022}. 

Although beta errors cannot be completely avoided, it is important to recognise their potential impact on the results. 
In this thesis, particular attention is paid to identifying where beta errors may occur and considering how they might influence the findings. 
Sensitivity checks are applied where relevant to assess the robustness of the findings and to reduce the risk of misinterpretation. %TODO: No no sensitivity checks are applied so far.

\subsubsection{Measurement Errors in Income Data}
A persistent challenge in empirical research is the presence of measurement errors in income data, which can bias the estimation of policy outcomes. 
In the context of our study, accurate measurement of both parental and student incomes is crucial, as these variables are the primary determinants of the theoretical BAföG entitlement to be calculated.

To assess the impact of potential income misreporting or data imperfections, we conduct a sensitivity analysis by introducing normally distributed noise to the log-transformed income variables. 
Logging is applied to address the right-skewness in the income distributions (see Figure~\ref{fig:income-distributions}). 
By simulating random measurement errors in logged income, we can evaluate how such noise affects the estimated non-take-up rates and the reliability (i.e., beta errors) of the simulation outcomes.

This approach allows us to better understand the robustness of our results to plausible inaccuracies in income reporting, and highlights the importance of data quality in studies of means-tested student aid.
