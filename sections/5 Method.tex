%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Method
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Method} 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Microsimulation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Microsimulation of Theoretical BAföG Eligibility} 
\subsubsection{Purpose and Scope}
The microsimulation pipeline is designed to calculate a theoretical BAföG eligibility status and award amount for students in the SOEP-Core sample. 
Its primary purpose is to compare these simulated entitlements with de facto BAföG take-up, as reported in SOEP.

To construct the theoretical values, the model replicates the legal rules and means-testing procedures defined in the Bundesausbildungsförderungsgesetz (BAföG) for the years 2007 to 2021. 
These rules are applied to individual-level SOEP data, including detailed information on income, assets, housing costs, and household structure.

This approach enables a systematic assessment of the alignment between statutory entitlements and actual BAföG participation. 
Deviations between the modeled and reported outcomes may arise from reporting errors, exceptional administrative decisions, or incomplete data. 
Full documentation of the simulation logic and input structure is provided in Appendix ~\ref{appendix:microsimulation-pipeline} and ~\ref{appendix:simulation-example}.

\paragraph{Identifying the Non-Take-Up (NTU) Rate and Beta Error.} %TODO: Not referenced correctly
We define non-take-up of BAföG in line with Nelson and Nieuwenhuis (2019), as the circumstance when a person is eligible for welfare, but does not receive it. This is in line with terminology commonly used in literature on welfare take up rates. Non take up rate is thus the number of people who are eligible, but do not receive it, divided by the total number of people eligible. 


Formally, this is expressed as:

\begin{equation}
\Pr(\text{NTU} = 1 \mid M = 1) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 0 \ \text{and} \ M_i = 1\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 1\}}, \quad\text{where} 
\end{equation}

\begin{equation}
  \mathbf{1}\{\cdot\} =
  \begin{cases}
  1 & \text{if individual } i \text{ is eligible but does not take up BAföG}, \\
  0 & \text{otherwise}.
  \end{cases}
\label{eq:indicator-function-ntu}
\end{equation}


\paragraph{Beta Error (Type II Error).}  
It is worth noting, however, that these situations are often more complex. 
In some cases, individuals may receive BAföG even though they are not eligible. 
This can occur due to fraud or simply as a result of administrative errors. 
Such cases introduce the concept of beta errors. 
A beta error refers to the probability that a student receives BAföG despite being classified as ineligible by our model. 
It captures false positives in the eligibility classification; cases where students who should not qualify according to the simulation nonetheless receive financial support.

Formally, it is expressed as:
\begin{equation}
\Pr(\text{TU} = 1 \mid M = 0) = \frac{\sum_{i=1}^{N} \mathbf{1}\{R_i = 1 \ \text{and} \ M_i = 0\}}{\sum_{i=1}^{N} \mathbf{1}\{M_i = 0\}},
\end{equation}
where \( \mathbf{1}\{\cdot\} \) is the indicator function defined as
\[
\mathbf{1}\{\cdot\} =
\begin{cases}
1 & \text{if individual } i \text{ is ineligible but receives BAföG}, \\
0 & \text{otherwise}.
\end{cases}
\]

% Maybe ref all our data sources, the statutory and soep
\subsubsection{Simulation Pipeline}

\paragraph{Constructing the Student Dataset.}
The pipeline begins by assembling a harmonized dataset of student-level observations from SOEP-Core and manually harmonizing variables which are not harmonized already.
This is achieved by filtering for individuals who are enrolled in education, fall within the relevant survey years, and are at least 18 years old. 
To ensure a valid estimation of parental contributions, the dataset is further restricted to cases where income data from both legal parents are observable in the panel in order to reduce bias and ensure validity of estimated parental contributions.

The resulting student-level dataframe integrates sociodemographic variables including sex, age, partnership status, number of siblings, number of children, household composition, and federal state of residence. 
Gross student income is also appended at this stage. 
Net student income is derived from gross values by applying year-specific rules for income tax, solidarity surcharge, church tax (where applicable), and standard deductions (e.g., Werbungskostenpauschale), in accordance with §§\,21–23 BAföG \citep{bafoeg_law}.
This net income will later be used to compute the student’s excess income as part of the BAföG need assessment.


\paragraph{Estimating Parental Contributions.}
In the next step, the simulation pipeline aggregates and evaluates parental income to estimate the expected contribution toward the student’s BAföG entitlement. 
For each student, the incomes of both legal parents—identified within the household and linked through SOEP family structure data—are retrieved and converted into annual net income. 
These values account for deductions such as income tax, solidarity surcharge, and church tax, where applicable.

Net incomes from both parents are combined into a joint parental income measure. 
From this, the model subtracts statutory allowances as defined in §§\,24–25 BAföG \citep{bafoeg_law}, which vary depending on the number of parents, number of dependent children, and year-specific legal thresholds. 
Additional deductions are applied if the student has siblings who might also be eligible for support. 
The result is a measure of excess parental income, which feeds directly into the theoretical award calculation in the next stage.

A complete breakdown of the income transformation, applicable thresholds, and illustrative examples is provided in Appendix~\ref{appendix:simulation-example}.

\paragraph{Asset Test.}
The simulation includes an asset test to assess whether students hold financial resources above the statutory exemption thresholds. 
For each student, information on financial assets, real estate, business holdings, private insurances, vehicles, and other tangible property is combined, and reported debts are subtracted to derive total net assets.

Since asset data in SOEP are only collected every five years, missing observations for non-surveyed years are filled using linear interpolation. 
This approach allows for year-specific asset estimates that remain consistent with observed data and ensures full coverage across the entire simulation period.

Total assets are then compared against exemption thresholds defined in §\,29 BAföG \citep{bafoeg_law}, which vary by age, partnership status, and number of dependent children. 
Any amount exceeding the applicable allowance is classified as excess assets and contributes to reducing the student's calculated need. 


\paragraph{Need calculation and theoretical entitlement.}
In the final stage, the simulation model calculates the student's funding need by summing the statutory base need, housing allowance, and health insurance supplement, as defined in §\,13 BAföG \citep{bafoeg_law}. 
From this total, the model subtracts any excess income attributable to the student, their parents, and their assets. 
The resulting amount determines the theoretical monthly BAföG entitlement.

A positive entitlement does not automatically imply eligibility: the model also applies age-based eligibility criteria. 
Students are only considered theoretically eligible if they meet the age requirements defined in the law, typically under 30 for undergraduate studies and under 35 for graduate-level programs. 
The final output includes both the simulated monthly award and a binary eligibility flag, which are used for comparison against self-reported values in SOEP. 
Detailed examples of this calculation and relevant thresholds are provided in Appendix~\ref{appendix:simulation-example}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Binary Choice Model of Non-Take-Up
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Binary Choice Model}
After simulating statutory eligibility, we analyse behavioural non-take-up: the probability that a student refrains from taking up BAföG despite being theoretically eligible according to our microsimulation. 
We model both using a Logit and a Probit model.

\subsubsection{Probit Model}
Formally, we model
\begin{equation}
  \Pr(\mathrm{NTU}_i = 1 \mid \mathbf{X}_i) = \Phi(\mathbf{X}^\top \boldsymbol{\beta})
  , \qquad \text{for all } i \text{ with } T_i = 1,
\end{equation}
where \( \Phi(\cdot) \) denotes the cumulative distribution function of the standard normal distribution. 

Here, \( T_i = 1 \) indicates the theoretical eligibility outcome of our microsimulation, and \( \mathrm{NTU}_i := \mathbf{1}\{R_i = 0\} \) is a binary indicator for non-take-up, based on the observed receipt in SOEP-Core (with \( R_i = 1 \) indicating receipt of BAföG and \( R_i = 0 \) otherwise).

\subsubsection{Logit Model}
In the same way as the Probit model, we fit a Logit model
\begin{equation}
  \Pr(\mathrm{NTU}_i = 1 \mid \mathbf{X}_i) = \Lambda(\mathbf{X}^\top \boldsymbol{\beta})
  , \qquad \text{for all } i \text{ with } T_i = 1,
\end{equation}
where \( \Lambda(\cdot) \) denotes the logistic cumulative distribution function
\begin{equation}
  \Lambda(z) = \frac{1}{1 + e^{-z}}.
\end{equation}

\subsubsection{Interpretation.} %TODO: Maybe explain latent index more -- don't fully understand atm
Since raw logit and probit coefficients reflect changes in the latent index and are not directly interpretable in terms of outcome probabilities, we report average marginal effects (AMEs) for all covariates. These AMEs quantify the average change in the probability of non-take-up associated with a one-unit change in each covariate, holding other variables at their observed values.

\paragraph{Control Variables.}
Our models include a set of control variables to account for observed heterogeneity that may influence the probability of non-take-up. These controls include demographic factors (e.g., sex, migration background, partnership status, living situation), socioeconomic characteristics (e.g., parental income, own income, parental education), and family context (e.g., sibling previously claimed BAföG). We also control for regional differences using an East/West Germany background indicator, reflecting known structural and cultural variations. Finally, to capture behavioral differences that might affect take-up decisions, we include a measure of individual risk appetite. These covariates help isolate the association between key predictors and non-take-up by adjusting for potential confounders.


\subsection{Model limitations}
\label{subsection:model_limitations}

\paragraph{Addressing beta errors in eligibility simulations.}
In simulating benefit non-take-up, beta errors occur when individuals report receiving a benefit but are classified by the model as ineligible. 
These mismatches typically reflect limitations in the input data, particularly income and assets.
Since the data in this study is self-reported, inaccuracies may occur in both income and benefit receipt.
Without administrative records, it is not possible to confirm whether a student was truly eligible or actually received the benefit. 
Some studies suggest that beta errors are more often caused by issues in the income or asset data used for eligibility simulation, rather than incorrect reporting of benefit receipt \citep{frick_claim_2007, janssens_takemod_2022}. 

To address these limitations, several strategies are used in the literature. 
These include conducting sensitivity checks by adjusting income levels and applying post-simulation corrections to reclassify borderline cases \citep{herber_non-take-up_2019}. 
Some studies also emphasize the value of combining different data sources where possible, such as using more detailed survey modules on assets or household composition to improve the accuracy of eligibility simulations \citep{janssens_takemod_2022}. 

Although beta errors cannot be completely avoided, it is important to recognise their potential impact on the results. 
In this thesis, particular attention is paid to identifying where beta errors may occur and considering how they might influence the findings. 
Sensitivity checks are applied where relevant to assess the robustness of the findings and to reduce the risk of misinterpretation. %TODO: No no sensitivity checks are applied so far.

%TODO: Also haven't adressed the interpolation of assets

